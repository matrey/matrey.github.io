{"hash":"12af9d4e0da958d8b8f02a961061a15f609ef26b","data":{"tag":{"title":"static-site-generator","belongsTo":{"edges":[{"node":{"title":"Static site with Hugo and GitHub Pages","path":"/articles/static-site-with-hugo-and-git-hub-pages/","date":"10 August 2019","last_update":null,"timeToRead":7,"description":"An exploration of Hugo, a static site generator, and how to host the resulting static website on GitHub pages.","content":"<p>An exploration of Hugo, a static site generator, and how to host the resulting static website on GitHub pages.</p>\n<p><strong>As of 2020, I have switched from Hugo to Gridsome. Gridsome's main benefit is that it is just VueJS when you need to do something a bit advanced.</strong></p>\n<h2 id=\"why-hugo\"><a href=\"#why-hugo\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Why Hugo?</h2>\n<p>Benefits of a static site:</p>\n<ul>\n<li>cheap to host</li>\n<li>good security (no server-side interpreter)</li>\n<li>good performance</li>\n</ul>\n<p>Benefits of Hugo (e.g. compared to Jekyll or Hexo):</p>\n<ul>\n<li>single binary</li>\n<li>fast building time</li>\n</ul>\n<h2 id=\"hugo-quick-start\"><a href=\"#hugo-quick-start\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Hugo Quick Start</h2>\n<p>We will follow the steps in Hugo's <a href=\"https://gohugo.io/getting-started/quick-start/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Quick Start guide</a>.</p>\n<h3 id=\"step-1-install-hugo\"><a href=\"#step-1-install-hugo\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 1: Install Hugo</h3>\n<p>Go get the latest binary from <a href=\"https://github.com/gohugoio/hugo/releases\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/gohugoio/hugo/releases</a>.\n<em>Remark: there is an \"extended\" version with native support for SASS/SCSS &#x26; PostCSS.</em></p>\n<h3 id=\"step-2-create-a-new-site\"><a href=\"#step-2-create-a-new-site\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 2: Create a New Site</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ ./hugo new site matrey</span>\n<span style=\"color: #D8DEE9FF\">$ </span><span style=\"color: #88C0D0\">cd</span><span style=\"color: #D8DEE9FF\"> matrey</span></code></pre>\n<p>Let's check the <a href=\"https://gohugo.io/getting-started/directory-structure/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">directory structure</a> that was generated:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ ls -1 --group-directories-first</span>\n<span style=\"color: #D8DEE9FF\">archetypes</span>\n<span style=\"color: #D8DEE9FF\">content</span>\n<span style=\"color: #D8DEE9FF\">data</span>\n<span style=\"color: #D8DEE9FF\">layouts</span>\n<span style=\"color: #D8DEE9FF\">resources</span>\n<span style=\"color: #D8DEE9FF\">static</span>\n<span style=\"color: #D8DEE9FF\">themes</span>\n<span style=\"color: #D8DEE9FF\">config.toml</span></code></pre>\n<p>Mainly:</p>\n<ul>\n<li>create your pages under <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">content</code></li>\n<li>put assets (JS, images...) under <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">static</code></li>\n<li>override theme layouts under <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">layouts</code></li>\n</ul>\n<p>By default only 2 files exist:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ find </span><span style=\"color: #88C0D0\">.</span><span style=\"color: #D8DEE9FF\"> -type f</span>\n<span style=\"color: #D8DEE9FF\">./config.toml</span>\n<span style=\"color: #D8DEE9FF\">./archetypes/default.md</span>\n\n<span style=\"color: #D8DEE9FF\">$ cat ./archetypes/default.md </span>\n<span style=\"color: #D8DEE9FF\">---</span>\n<span style=\"color: #D8DEE9FF\">title: </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">{{ replace .Name </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\">-</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\"> | title }}</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">date: {{ .Date }}</span>\n<span style=\"color: #D8DEE9FF\">draft: </span><span style=\"color: #88C0D0\">true</span>\n<span style=\"color: #D8DEE9FF\">---</span>\n\n<span style=\"color: #D8DEE9FF\">$ cat ./config.toml</span>\n<span style=\"color: #D8DEE9FF\">baseURL = </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">http://example.org/</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">languageCode = </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">en-us</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">title = </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">My New Hugo Site</span><span style=\"color: #ECEFF4\">\"</span></code></pre>\n<p>Let's push that to the git repository holding the source: </p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ git init</span>\n<span style=\"color: #D8DEE9FF\">$ git remote add origin git@github.com:matrey/matrey.github.io-source.git</span>\n<span style=\"color: #D8DEE9FF\">$ git add </span><span style=\"color: #88C0D0\">.</span>\n<span style=\"color: #D8DEE9FF\">$ git commit -m </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">./hugo new site</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">$ git push -u origin master</span></code></pre>\n<h3 id=\"step-3-add-a-theme\"><a href=\"#step-3-add-a-theme\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 3: Add a Theme</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ git submodule add https://github.com/nanxiaobei/hugo-paper.git themes/hugo-paper</span>\n<span style=\"color: #D8DEE9FF\">$ </span><span style=\"color: #88C0D0\">echo</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">theme = \"hugo-paper\"</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&gt;&gt;</span><span style=\"color: #D8DEE9FF\"> config.toml</span>\n<span style=\"color: #D8DEE9FF\">$ git add config.toml</span>\n<span style=\"color: #D8DEE9FF\">$ git commit -m </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Add hugo-paper theme</span><span style=\"color: #ECEFF4\">\"</span></code></pre>\n<p>Importing the theme as a git submodule means we won't be able to edit its source code as part of our codebase.\nBut that's alright, because the proper way to overload a theme is by leveraging Hugo's <a href=\"https://gohugo.io/templates/lookup-order/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lookup order</a>.</p>\n<p>For instance for a <a href=\"https://zwbetz.com/override-a-hugo-theme/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">layout change</a>:</p>\n<blockquote>\n<p>Let’s say you really like theme foo, but you wish the homepage was different. All you have to do is copy the homepage template:</p>\n<p><code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">your-site/themes/foo/layouts/index.html</code></p>\n<p>And paste it under your own layouts folder:</p>\n<p><code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">your-site/layouts/index.html</code></p>\n</blockquote>\n<h3 id=\"step-4-add-some-content\"><a href=\"#step-4-add-some-content\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 4: Add Some Content</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ ../hugo new articles/static-site-hugo-github-pages.md</span></code></pre>\n<p>You might want to get a refresher course on Markdown from this <a href=\"https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Markdown Cheatsheet</a>.</p>\n<p>Note that you can explicitly add a summary divider in your page content, to control what content is shown on pagelists.\nAccording to <a href=\"https://gohugo.io/content-management/summaries/#manual-summary-splitting\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Manual Summary Splitting</a>:</p>\n<blockquote>\n<p>[...] you may add the <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">&lt;!--more--&gt;</code> summary divider where you want to split the article.</p>\n<p>Content that comes before the summary divider will be used as that content’s summary and stored in the <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">.Summary</code> page variable with all HTML formatting intact.</p>\n<p>Be careful to enter <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">&lt;!--more--&gt;</code> exactly; i.e., all lowercase and with no whitespace.</p>\n</blockquote>\n<h3 id=\"step-5-start-the-hugo-server\"><a href=\"#step-5-start-the-hugo-server\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 5: Start the Hugo server</h3>\n<p>By default Hugo will not publish content in \"draft\" status</p>\n<p>Start the Hugo server for local development, with drafts:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">../hugo server -D</span></code></pre>\n<p><em>If you are not in the root folder from the Hugo site, you can pass its path through <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">-s ~/my-hugo-site</code></em></p>\n<p>Then navigate to your new site at <a href=\"http://localhost:1313/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:1313/</a></p>\n<h2 id=\"make-hugo-deployment-ready\"><a href=\"#make-hugo-deployment-ready\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Make Hugo deployment-ready</h2>\n<h3 id=\"footer-copyright\"><a href=\"#footer-copyright\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Footer copyright</h3>\n<p>Let's change the copyright holder in the footer.\nUnfortunately it is hardcoded to <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">.Site.Title</code> in the template, so we will have to overload it:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ mkdir -p ./layouts/partials/</span>\n<span style=\"color: #D8DEE9FF\">$ cp ./themes/hugo-paper/layouts/partials/footer.html ./layouts/partials/</span></code></pre>\n<p><em>Note that the <a href=\"https://gohugo.io/variables/site/#site-variables-list\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Site Variables</a> page mentions <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">.Site.Author</code> as a variable that should be available by default.\nWhen using it in the layout, it's true there is no error (so, the variable seems to exist), but it ends up reading <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">© 2019 map[]</code>.\nIt's really unclear <a href=\"https://github.com/gohugoio/hugo/issues/4458\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">what</a> <a href=\"https://discourse.gohugo.io/t/site-authors-not-implemented/10446/6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">is</a> <a href=\"https://github.com/gohugoio/hugo/issues/3088\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the</a> <a href=\"https://hugomodo.github.io/blog/hugo-s-author-and-authors/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">status</a> on this feature. So we'll use a distinct variable.</em></p>\n<p>Let's create a new variable in <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">config.toml</code> by adding the following:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">[params]</span>\n<span style=\"color: #D8DEE9FF\">  AuthorName = </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Mathieu Rey</span><span style=\"color: #ECEFF4\">\"</span></code></pre>\n<p>Then edit our copy of the footer to use <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">.Site.Params.AuthorName</code>:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ diff ./themes/hugo-paper/layouts/partials/footer.html ./layouts/partials/footer.html</span>\n<span style=\"color: #D8DEE9FF\">3c3</span>\n<span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">   </span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">span</span><span style=\"color: #81A1C1\">&gt;&</span><span style=\"color: #D8DEE9FF\">copy</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> {{ now.Year }} </span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">a href=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">{{ </span><span style=\"color: #ECEFF4\">\"\"</span><span style=\"color: #A3BE8C\"> | absURL }}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">&gt;</span><span style=\"color: #D8DEE9FF\">{{ .Site.Title }}</span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">/a</span><span style=\"color: #81A1C1\">&gt;&lt;</span><span style=\"color: #D8DEE9FF\">/span</span><span style=\"color: #81A1C1\">&gt;</span>\n<span style=\"color: #D8DEE9FF\">---</span>\n<span style=\"color: #81A1C1\">&gt;</span><span style=\"color: #D8DEE9FF\">   </span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">span</span><span style=\"color: #81A1C1\">&gt;&</span><span style=\"color: #D8DEE9FF\">copy</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> {{ now.Year }} </span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">a href=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">{{ </span><span style=\"color: #ECEFF4\">\"\"</span><span style=\"color: #A3BE8C\"> | absURL }}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">&gt;</span><span style=\"color: #D8DEE9FF\">{{ .Site.Params.AuthorName }}</span><span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">/a</span><span style=\"color: #81A1C1\">&gt;&lt;</span><span style=\"color: #D8DEE9FF\">/span</span><span style=\"color: #81A1C1\">&gt;</span></code></pre>\n<h3 id=\"publication-folder\"><a href=\"#publication-folder\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Publication folder</h3>\n<p>By default the publication folder is named <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">public</code>. Let's set a more explicit one in <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">config.toml</code>:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">publishDir = </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">matrey.github.io</span><span style=\"color: #ECEFF4\">\"</span></code></pre>\n<p>Also, don't forget to replace the default <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">baseURL</code> with the real production URL (including a trailing slash):</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">baseURL = </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">https://matrey.github.io/</span><span style=\"color: #ECEFF4\">\"</span></code></pre>\n<p>Let's publish the site by calling <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">hugo</code> without any parameter:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ ../hugo</span>\n\n<span style=\"color: #D8DEE9FF\">$ find matrey.github.io/</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/tags</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/tags/index.html</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/tags/index.xml</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/tags/page</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/tags/page/1</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/tags/page/1/index.html</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/sitemap.xml</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/index.html</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/index.xml</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/js</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/js/instantclick.min.js</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/js/highlight.min.js</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/css</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/css/github-gist.min.css</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/css/style.css</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/img</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/img/favicon.ico</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/img/apple-touch-icon.png</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/page</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/page/1</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/page/1/index.html</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/categories</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/categories/index.html</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/categories/index.xml</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/categories/page</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/categories/page/1</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/categories/page/1/index.html</span>\n<span style=\"color: #D8DEE9FF\">matrey.github.io/404.html</span></code></pre>\n<p>Note that Hugo <a href=\"https://gohugo.io/getting-started/usage/#dev-vs-deploy-destinations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">does not remove generated files before building</a>.\nIt might be a good idea to purge the folder's contents before each generation.</p>\n<p>Let's also exclude the publication folder from the main git repo, as it will have its own repo:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #88C0D0\">echo</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">/matrey.github.io/**</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&gt;&gt;</span><span style=\"color: #D8DEE9FF\"> .gitignore</span></code></pre>\n<p><em>Note that we could have made this a git submodule, like for the theme. But we are not interested in tracking changes in this repo (as it can be re-generated from the source in the main repo). Using a submodule would quickly bother us with this kind of display:</em></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ git status</span>\n<span style=\"color: #D8DEE9FF\">On branch master</span>\n<span style=\"color: #D8DEE9FF\">Your branch is up to date with </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">origin/master</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">.</span>\n\n<span style=\"color: #D8DEE9FF\">Changes not staged </span><span style=\"color: #81A1C1\">for</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">commit:</span>\n<span style=\"color: #D8DEE9FF\">  </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">use </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">git add &lt;file&gt;...</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> to update what will be committed</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">  </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">use </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">git checkout -- &lt;file&gt;...</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> to discard changes </span><span style=\"color: #81A1C1\">in</span><span style=\"color: #D8DEE9FF\"> working directory</span><span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">\tmodified:   matrey.github.io </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">new commits</span><span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">no changes added to commit </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">use </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">git add</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> and/or </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">git commit -a</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<h2 id=\"github-pages\"><a href=\"#github-pages\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>GitHub pages</h2>\n<h3 id=\"create-the-repository\"><a href=\"#create-the-repository\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Create the repository</h3>\n<p>For a user site, you just need to create a new repository named <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">username.github.io</code>, where <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">username</code> is your username on GitHub.</p>\n<p>Let's push the contents of our publication folder to it:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ </span><span style=\"color: #88C0D0\">cd</span><span style=\"color: #D8DEE9FF\"> matrey.github.io/</span>\n<span style=\"color: #D8DEE9FF\">$ git init </span><span style=\"color: #88C0D0\">.</span>\n<span style=\"color: #D8DEE9FF\">$ git add </span><span style=\"color: #88C0D0\">.</span>\n<span style=\"color: #D8DEE9FF\">$ git commit -m </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Hello world</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">$ git remote add origin git@github.com:matrey/matrey.github.io.git</span>\n<span style=\"color: #D8DEE9FF\">$ git push -u origin master</span></code></pre>\n<p>Note that changes might not appear immediately, due to CDN caching on GitHub side.</p>\n<h3 id=\"custom-404-page\"><a href=\"#custom-404-page\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Custom 404 page</h3>\n<p>You just need to have a file named <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">404.html</code> at the root of your site.\nIt turns out Hugo <a href=\"https://gohugo.io/templates/404/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">takes care of it natively</a>:</p>\n<blockquote>\n<p>When using Hugo with GitHub Pages, you can provide your own template for a custom 404 error page by creating a <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">404.html</code> template file in your <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">/layouts</code> folder. When Hugo generates your site, the <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">404.html</code> file will be placed in the root.</p>\n</blockquote>\n<p>The theme we picked already provides a basic version:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">$ cat themes/hugo-paper/layouts/404.html </span>\n<span style=\"color: #D8DEE9FF\">{{ partial </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">header.html</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">.</span><span style=\"color: #D8DEE9FF\"> }}</span>\n<span style=\"color: #81A1C1\">&lt;</span><span style=\"color: #D8DEE9FF\">div class=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">not-found</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">&gt;404&lt;</span><span style=\"color: #D8DEE9FF\">/div</span><span style=\"color: #81A1C1\">&gt;</span>\n<span style=\"color: #D8DEE9FF\">{{ partial </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">footer.html</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">.</span><span style=\"color: #D8DEE9FF\"> }}</span></code></pre>\n<h2 id=\"scripting-the-publication\"><a href=\"#scripting-the-publication\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Scripting the publication</h2>\n<p>What we want:</p>\n<ul>\n<li>clear the publication folder to make sure we remove content that should not be there anymore</li>\n<li>run the Hugo compilation</li>\n<li>commit all files</li>\n<li>push to GitHub to update the website</li>\n</ul>\n<p>Let's adapt the <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">deploy.sh</code> <a href=\"https://gohugo.io/hosting-and-deployment/hosting-on-github/#put-it-into-a-script\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">script</a> from Hugo's documentation:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\">#!/bin/bash</span>\n<span style=\"color: #D8DEE9FF\">DIR=</span><span style=\"color: #ECEFF4\">\"$(</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #88C0D0\">cd</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #ECEFF4\">\"$(</span><span style=\"color: #A3BE8C\"> dirname </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">BASH_SOURCE</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9\">0</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #ECEFF4\">)\"</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #81A1C1\">&&</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #88C0D0\">pwd</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #ECEFF4\">)\"</span>\n\n<span style=\"color: #4C566A\"># Adapted from https://gohugo.io/hosting-and-deployment/hosting-on-github/#put-it-into-a-script</span>\n\n<span style=\"color: #4C566A\"># /!\\ Paths to edit /!\\</span>\n<span style=\"color: #D8DEE9FF\">HUGO_BIN=../hugo</span>\n<span style=\"color: #D8DEE9FF\">PUBLICATION_DIR=matrey.github.io</span>\n\n<span style=\"color: #4C566A\"># If a command fails then the deploy stops</span>\n<span style=\"color: #88C0D0\">set</span><span style=\"color: #D8DEE9FF\"> -e</span>\n\n<span style=\"color: #4C566A\"># Clear the publication folder (except the .git folder)</span>\n<span style=\"color: #4C566A\"># Thanks https://stackoverflow.com/a/22347541/8046487</span>\n<span style=\"color: #88C0D0\">cd</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">DIR</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #A3BE8C\">/</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">PUBLICATION_DIR</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #88C0D0\">printf</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">\\033[0;32mCleanup target folder...\\033[0m\\n</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">git rm -rf </span><span style=\"color: #88C0D0\">.</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\"># removes all versioned files</span>\n<span style=\"color: #D8DEE9FF\">git clean -fxd </span><span style=\"color: #4C566A\"># removes any file not under version control</span>\n\n<span style=\"color: #4C566A\"># Build the project</span>\n<span style=\"color: #88C0D0\">cd</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">DIR</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #88C0D0\">printf</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">\\033[0;32mHugo build...\\033[0m\\n</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">HUGO_BIN</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #ECEFF4\">\"</span>\n\n<span style=\"color: #4C566A\"># Add changes to git</span>\n<span style=\"color: #88C0D0\">cd</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">DIR</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #A3BE8C\">/</span><span style=\"color: #81A1C1\">${</span><span style=\"color: #D8DEE9\">PUBLICATION_DIR</span><span style=\"color: #81A1C1\">}</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">git add </span><span style=\"color: #88C0D0\">.</span>\n\n<span style=\"color: #4C566A\"># Commit changes</span>\n<span style=\"color: #88C0D0\">printf</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">\\033[0;32mCommit to git...\\033[0m\\n</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">msg=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Hugo rebuild on </span><span style=\"color: #ECEFF4\">$(</span><span style=\"color: #A3BE8C\">date</span><span style=\"color: #ECEFF4\">)\"</span>\n<span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> [ -n </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">*</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #D8DEE9FF\"> ]</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">then</span>\n<span style=\"color: #D8DEE9FF\">  msg=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">*</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #81A1C1\">fi</span>\n<span style=\"color: #D8DEE9FF\">git commit -m </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">msg</span><span style=\"color: #ECEFF4\">\"</span>\n\n<span style=\"color: #4C566A\"># Push to GitHub</span>\n<span style=\"color: #88C0D0\">printf</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">\\033[0;32mPush to GitHub...\\033[0m\\n</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">git push origin master</span>\n\n<span style=\"color: #88C0D0\">exit</span><span style=\"color: #D8DEE9FF\"> 0</span></code></pre>\n<p>Note that this only takes care of the published version. Don't forget to also commit your changes in the source repository.</p>\n"}}]}}},"context":{}}